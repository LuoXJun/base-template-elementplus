<template>
    <div class="toolsBar">
        <div
            v-for="it in tools"
            @click="draw(it)"
            :class="{
                isSelected: currentDrawItem.type === it.type
            }"
            @mouseover="currentDrawItem.hoverLabel = it.label"
            @mouseleave="currentDrawItem.hoverLabel = ''"
        >
            <svg
                v-if="it.type === 'rectangle'"
                t="1765852848222"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="1607"
                width="32"
                height="32"
            >
                <path
                    d="M0 1024V0h1024v1024H0zM950.857 73.143H73.143v877.714h877.714V73.143zM868.571 868.57h-704v-704h704v704z"
                    fill="#325691"
                    p-id="1608"
                    data-spm-anchor-id="a313x.search_index.0.i1.76cf3a81AAcXWJ"
                    class="selected"
                ></path>
            </svg>
            <svg
                v-if="it.type === 'polygon'"
                t="1765853164705"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="3820"
                width="32"
                height="32"
            >
                <path
                    d="M803.729493 876.245333a64 64 0 1 1-76.885333 75.349334H297.53216a64 64 0 1 1-112.384-53.248l-132.821333-408.746667a64 64 0 1 1 25.386666-125.482667l353.152-256.469333a64 64 0 1 1 120.021334-0.042667l369.834666 268.672a64 64 0 1 1 10.581334 107.52l-127.573334 392.448z m-280.32-735.829333a63.701333 63.701333 0 0 1-65.109333 0L116.02816 389.12a64 64 0 0 1-20.992 93.653333l127.701333 393.045334a64 64 0 0 1 68.821334 33.109333H732.774827c5.418667-10.282667 13.568-18.944 23.466666-25.002667l142.634667-438.698666a64 64 0 0 1-1.152-32.810667l-374.357333-272zM490.854827 192l344.917333 250.581333-131.754667 405.504H277.69216l-131.754667-405.504L490.854827 192z"
                    fill="#325691"
                    p-id="3821"
                ></path>
            </svg>
            <svg
                v-if="it.type === 'line'"
                t="1765853228039"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="6845"
                width="32"
                height="32"
            >
                <path
                    d="M827.076923 157.538462a39.384615 39.384615 0 1 1-14.375385 76.051692L233.590154 812.701538a39.384615 39.384615 0 1 1-22.291692-22.291692L790.409846 211.298462A39.384615 39.384615 0 0 1 827.076923 157.538462z"
                    fill="#325691"
                    p-id="6846"
                ></path>
            </svg>
            <svg
                v-if="it.type === 'point'"
                t="1765853294355"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="11457"
                width="32"
                height="32"
            >
                <path
                    d="M917.219013 1006.301522h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037904h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037904s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037904h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037904s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037904h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037904s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037904h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037904s-8.970969 20.037904-20.037904 20.037904zM51.096655 990.757118c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037903 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037903 20.037904z m866.122358-82.578205c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037904 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037904 20.037904zM51.096655 770.340177c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037903 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037903 20.037904z m866.122358-82.578205c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037904 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037904 20.037904zM51.096655 549.923236c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037903 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037903 20.037904z m866.122358-82.578205c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037904 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037904 20.037904zM51.096655 329.506295c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037903 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037903 20.037904z m866.122358-82.578205c-11.066934 0-20.037904-8.970969-20.037904-20.037904v-60.113711c0-11.066934 8.970969-20.037904 20.037904-20.037904s20.037904 8.970969 20.037904 20.037904v60.113711c0 11.066934-8.970969 20.037904-20.037904 20.037904zM803.550998 140.179163h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037903h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037903s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037903h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037903s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037903h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037903s-8.970969 20.037904-20.037904 20.037904z m-220.416941 0h-60.113711c-11.066934 0-20.037904-8.970969-20.037904-20.037904s8.970969-20.037904 20.037904-20.037903h60.113711c11.066934 0 20.037904 8.970969 20.037904 20.037903s-8.970969 20.037904-20.037904 20.037904z"
                    fill="#325691"
                    p-id="11458"
                ></path>
                <path
                    d="M889.701962 131.977649m-101.920794 0a101.920794 101.920794 0 1 0 203.841587 0 101.920794 101.920794 0 1 0-203.841587 0Z"
                    fill="#325691"
                    p-id="11459"
                ></path>
            </svg>
            <svg
                v-if="it.type === 'remove'"
                t="1765853350916"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="12653"
                width="32"
                height="32"
            >
                <path
                    d="M254.398526 804.702412l-0.030699-4.787026C254.367827 801.546535 254.380106 803.13573 254.398526 804.702412zM614.190939 259.036661c-22.116717 0-40.047088 17.910928-40.047088 40.047088l0.37146 502.160911c0 22.097274 17.930371 40.048111 40.047088 40.048111s40.048111-17.950837 40.048111-40.048111l-0.350994-502.160911C654.259516 276.948613 636.328122 259.036661 614.190939 259.036661zM893.234259 140.105968l-318.891887 0.148379-0.178055-41.407062c0-22.13616-17.933441-40.048111-40.067554-40.048111-7.294127 0-14.126742 1.958608-20.017916 5.364171-5.894244-3.405563-12.729929-5.364171-20.031219-5.364171-22.115694 0-40.047088 17.911952-40.047088 40.048111l0.188288 41.463344-230.115981 0.106424c-3.228531-0.839111-6.613628-1.287319-10.104125-1.287319-3.502777 0-6.89913 0.452301-10.136871 1.296529l-73.067132 0.033769c-22.115694 0-40.048111 17.950837-40.048111 40.047088 0 22.13616 17.931395 40.048111 40.048111 40.048111l43.176358-0.020466 0.292666 617.902982 0.059352 0 0 42.551118c0 44.233434 35.862789 80.095199 80.095199 80.095199l40.048111 0 0 0.302899 440.523085-0.25685 0-0.046049 40.048111 0c43.663452 0 79.146595-34.95 80.054267-78.395488l-0.329505-583.369468c0-22.135136-17.930371-40.047088-40.048111-40.047088-22.115694 0-40.047088 17.911952-40.047088 40.047088l0.287549 509.324054c-1.407046 60.314691-18.594497 71.367421-79.993892 71.367421l41.575908 1.022283-454.442096 0.26606 52.398394-1.288343c-62.715367 0-79.305207-11.522428-80.0645-75.308173l0.493234 76.611865-0.543376 0-0.313132-660.818397 236.82273-0.109494c1.173732 0.103354 2.360767 0.166799 3.561106 0.166799 1.215688 0 2.416026-0.063445 3.604084-0.169869l32.639375-0.01535c1.25355 0.118704 2.521426 0.185218 3.805676 0.185218 1.299599 0 2.582825-0.067538 3.851725-0.188288l354.913289-0.163729c22.115694 0 40.050158-17.911952 40.050158-40.047088C933.283394 158.01792 915.349953 140.105968 893.234259 140.105968zM774.928806 815.294654l0.036839 65.715701-0.459464 0L774.928806 815.294654zM413.953452 259.036661c-22.116717 0-40.048111 17.910928-40.048111 40.047088l0.37146 502.160911c0 22.097274 17.931395 40.048111 40.049135 40.048111 22.115694 0 40.047088-17.950837 40.047088-40.048111l-0.37146-502.160911C454.00054 276.948613 436.069145 259.036661 413.953452 259.036661z"
                    fill="#325691"
                    p-id="12654"
                ></path>
            </svg>
            <svg
                v-if="it.type === 'reset'"
                t="1765853468562"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="15455"
                width="32"
                height="32"
            >
                <path
                    d="M213.55 270.24C400.23 39.63 767.42 99.5 871.68 377c19.58-7.28 39.84-15.03 59.87-22.31-71.71-191.45-263.84-309.6-467.13-288.2C261.13 88.34 98.59 244.51 69 446.43c95.84-27.32 192.36-55.32 288.2-82.64-48.26-30.95-95.61-62.14-143.65-93.55zM666.57 660.2l143.42 93.56C622.87 984.37 256.12 924.95 151.86 647c-19.58 7.28-39.84 15.03-59.87 22.31 71.71 191.45 263.84 309.6 467.13 288.2C762.41 936.11 925.41 779.94 955 577.57c-95.61 27.31-192.13 55.31-288.43 82.63z"
                    p-id="15456"
                    fill="#325691"
                ></path>
                <path
                    d="M393.85 512.23c0 65.11 52.59 117.92 117.69 117.92s117.92-52.59 117.92-117.69v-0.23c0-65.11-52.81-117.92-117.69-117.92s-117.92 52.81-117.92 117.92z"
                    p-id="15457"
                    fill="#325691"
                ></path>
            </svg>

            <p class="isHover" v-if="currentDrawItem.hoverLabel === it.label">
                {{ currentDrawItem.hoverLabel }}
            </p>
        </div>
    </div>
</template>

<script setup lang="ts">
import { useCesiumViewer } from '@/stores/useCesiumViewer';
import { DrawGeometry } from '@/utils/cesium-utils';
interface IToolBar {
    label: string;
    type: GeometryType | string;
}
const store = useCesiumViewer();
let drawMethods: DrawGeometry;

const currentDrawItem = reactive({
    type: '',
    label: '',
    hoverLabel: ''
});
const tools: IToolBar[] = [
    {
        label: '还原',
        type: 'reset'
    },
    {
        label: '点',
        type: 'point'
    },
    {
        label: '线',
        type: 'line'
    },
    {
        label: '面',
        type: 'polygon'
    },
    {
        label: '矩形',
        type: 'rectangle'
    },
    {
        label: '清空',
        type: 'remove'
    }
];

const draw = (row: IToolBar) => {
    if (!drawMethods) drawMethods = new DrawGeometry(store.Viewer!, store.getScreenSpaceHandler());

    if (!drawMethods) return alert('绘制工具未加载');

    if (row.type === 'remove') {
        drawMethods.clear();
    } else if (row.type === 'reset') {
        store.Viewer?.camera.setView({
            destination: Cesium.Rectangle.fromDegrees(73, 18, 135, 53)
        });
    } else {
        store.restoreScreenSpaceHandler();
        if (currentDrawItem.type === row.type) {
            currentDrawItem.type = '';
            return;
        }

        currentDrawItem.type = row.type;
        currentDrawItem.label = row.label;

        drawMethods.draw(row.type as GeometryType);
    }
};
</script>

<style scoped lang="scss">
$width: 50px;
.toolsBar {
    height: 50px;
    border-radius: 10px;
    padding: 0 20px;
    background: #fff;
    display: flex;
    align-items: center;
    > div {
        cursor: pointer;
        width: $width;
        height: 100%;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        &:hover {
            background-color: #e8f1ff;
        }
        &.isSelected {
            background-color: #e8f1ff;
        }

        .isHover {
            width: $width;
            border-radius: 2px;
            background-color: #ffffff;
            font-size: 14px;
            text-align: center;
            position: absolute;
            left: 50%;
            top: -2px;
            transform: translate(-50%, -100%);
        }
        > svg {
            width: 24px;
        }
    }
}
</style>
